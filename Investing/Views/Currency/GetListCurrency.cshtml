@model List<Investing.Models.Currency>

@{
    ViewData["Title"] = "Валюта Московской биржи";
}

<h1>Валюта Московской биржи</h1>

<div>
    <div class="section-type-currency">
        <div class="section-btns-type">
            <button id="btn-type-currrency-all" class="btn-type-currrency">Все</button>
            <button id="btn-type-currrency-money" class="btn-type-currrency">Денежные средства</button>
            <button id="btn-type-currrency-metall" class="btn-type-currrency">Драгоценные металлы</button>
        </div>
    </div>
<table class="table" id="sortTable">
    <thead>
        <tr>
            <th onclick="sortTable(0)">
                Название
            </th>
            <th onclick="sortTable(1)">
                Цена
            </th>
            <th onclick="sortTable(2)">
                За день
            </th>
        </tr>
    </thead>
    <tbody>
        @foreach (var currency in Model)
        {
            @if (currency.Marketdata.LAST.HasValue)
            {
             <tr style="@(currency.Marketdata?.TRADINGSTATUS == "N" ? "background-color: grey" : "background-color: white;")" onclick="window.location.href='@Url.Action("DetailCurrency", "Currency", new { secId = currency.Security.SECID })'; return false">
                <td>
                    <div class="company-info">
                        @if (!(currency.Security.IconCompany is null))
                        {
                            <img src="@String.Format("data:image/gif;base64,{0}", Convert.ToBase64String(@currency.Security.IconCompany))" class="company-logo">
                        }
                        else
                        {
                            <img src="~/images/logo.jpg" class="company-logo" />
                        }
                        <div>
                            <div class="company-name">@currency.Security.SHORTNAME</div>
                            <p class="company-description">От @currency.Security.LOTSIZE @currency.Security.FACEUNIT</p>
                        </div>
                    </div>
                </td>
                <td>@currency.Marketdata.LAST</td>

                        @{
                            string isWherePrice = "";
                            if(currency.Marketdata.LASTTOPREVPRICE > 0.1M)
                            {
                                isWherePrice = "plus-result";
                            }
                            else
                            {
                                isWherePrice = "minus-result";
                            }
                        }

            <td class="@isWherePrice">@currency.Marketdata.LASTTOPREVPRICE </td>
            </tr>   
            }
        }
    </tbody>
    </table>
</div>
<style>
    .company-info {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .company-info {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .company-logo {
        width: 40px;
        height: 40px;
        object-fit: contain;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
    }

    th, td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid #ddd;
    }

    th {
        background-color: #f4f4f4;
        cursor: pointer;
        position: relative;
    }

        th:hover {
            background-color: #ddd;
        }

    tr:hover {
        background-color: #f5f5f5;
    }

    .sort-icon {
        display: inline-flex;
        flex-direction: column;
        margin-left: 8px;
        vertical-align: middle;
    }

        .sort-icon svg {
            fill: #888;
            transition: fill 0.2s;
            width: 12px;
            height: 12px;
        }

        .sort-icon .asc,
        .sort-icon .desc {
            display: none;
        }

    th.asc .sort-icon .asc,
    th.desc .sort-icon .desc {
        display: inline-block;
    }

    th.asc .sort-icon .asc {
        fill: #000;
    }

    th.desc .sort-icon .desc {
        fill: #000;
    }

    .btn-type-currrency{
        width:200px;
        height:35px;
        margin:20px;
    }
    .plus-result{
        color: #43ed43;
        font-size:20px;
    }

    .minus-result {
        color: red;
        font-size: 20px;
    }
</style>